INCLUDE Irvine32.inc
INCLUDE macros.inc
includelib Winmm.lib

PlaySound PROTO,
        pszSound:PTR BYTE, 
        hmod:DWORD, 
        fdwSound:DWORD
.data
;18
maze db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
     db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0
     db "||                                                                                                                                                                                                                                      ||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||                                                                                                                                                                                                                                      ||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||                                                                                                                                                                                                                                      ||",0
	 db "||. . . .                   . .                              .               |                                                                             |              .           .                                           .     ||",0
	 db "||                                                                           |                                                                             |                                                                            ||",0
	 db "||                                                                           |                                                                             |                                                                            ||",0
	 db "||                                                                           |_______________                                               _______________|                                                                            ||",0
	 db "||.                   | . .                                                                 |                                               |                                                                      |               .    ||",0
	 db "||                    |                                                                     |                                               |                                                                      |                    ||",0
	 db "||                    |                                                                     |                                               |                                                                      |                    ||",0
	 db "||                    |           ___________                                               |                                               |                                 ___________                          |                    ||",0
	 db "||     .              |       .                                              .                                                                                   .                                                 |    .               ||",0
	 db "||                    |                                                                                                                                                                                            |                    ||",0
	 db "||                    |                                                                                                                                                                                            |                    ||",0
	 db "||         |          |           ___________                                                                       |                                                         ___________                          |          |         ||",0
	 db "||         |          |                                                                                             |                                                                                              |          |         ||",0
	 db "||         |          |                                                                                             |                                                                                              |          |         ||",0
	 db "||         | .      . | .                                      .                                                    |                           .                         .                                        |   .      | .       ||",0
	 db "||         |                                                                                                        |                                                                                                         |         ||",0
	 db "||         |                                                                                          --------------|----------------                                                                                         |         ||",0
	 db "||         |          |                                                                                             |                                                                                              |          |         ||",0
	 db "||         |          |                                                                                             |                                                                                              |          |         ||",0
	 db "||         |          |                                                                                             |                                                                                              |          |         ||",0
	 db "||.        | .        | .      .  ___________                .                    .                   .             |              .                                         .___________                 .        |          |    .    ||",0
	 db "||                    |                                                                                             |                                                                                              |                    ||",0
	 db "||                    |                                                                                                                                                                                            |                    ||",0
	 db "||                    |                                                                                                                                                                                            |                    ||",0
	 db "||            .       |    .      ___________                            .                  .           .           .                                                         ___________   .                      |       .            ||",0
	 db "||                    |                                                                     |                                                 |                                                                    |                    ||",0
	 db "||                    |                                                                     |                                                 |                                                                    |                    ||",0
	 db "||                    |                                                                     |                                                 |                                                                    |                    ||",0
	 db "||                    |                       .                               ______________|                                                 |_______________ .                                              .    |            .       ||",0
	 db "||                                                                            |                                                                              |                                                                          ||",0
	 db "||                                                                            |                                                                              |                                                                          ||",0
	 db "||                                                                            |                                                                              |                                                                          ||",0
	 db "||                        .                                .                  |                                                                              |. .                                      .                               .||",0
	 db "||                                                                                                                                                                                                                                      ||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||                                                                                                                                                                                                                                      ||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||                                                                                                                                                                                                                                      ||",0	 
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||                                                                                                                                                                                                                                      ||",0	 
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0	 
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0
	 db "                                                                                                                                                                                                                                          ",0
	 db "                                                                                                                                                                                                                                          ",0
	 db "                                                                                                                                                                                                                                          ",0

maze2 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|......... |..........|..........|..........|..........|..........|..........|..........|..........|.....................|..........|..........|......B...|..........|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
	 db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|......... |..........|..........|..........|.....B....|..........|..........|..........|..........|.....................|..........|..........|..........|..........|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||.B....|......... |..........|..........|..........|..........|..........|..........|..........|..........|.....................|..........|..........|..........|..........|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
	 db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|......... |..........|..........|..........|..........|..........|..........|..........|..........|........B............|..........|..........|..........|..........|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|......... |..........|..........|..........|..........|..........|..........|..........|..........|.....................|..........|..........|..........|..........|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|......... |..........|.....B....|..........|..........|..........|..........|..........|..........|.......B.............|..........|..........|..........|..........|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|......... |..........|..........|..........|..........|..........|..........|..........|..........|.....................|..........|..........|..........|.....B....|..........|..........|..........|..........|..........|...||",0
	 db "||      |          |          |          |          |          |          |          |          |          |                     |          |          |          |          |          |          |          |          |          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|           __________|          |__________|          |__________|          |__________|          |__________|          |...||",0
	 db "||                                                                                                                                                                                                                                      ||",0	 
	 db "||......................................................................................................................................................................................................................................||",0
	 db "||                                                                                                                                                                                                                                      ||",0	 
	 db "||......................................................................................................................................................................................................................................||",0
	 db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0	 
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0
	 db "                                                                                                                                                                                                                                          ",0
	 db "                                                                                                                                                                                                                                          ",0
	 db "                                                                                                                                                                                                                                          ",0


maze3 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||------|----..... |..........|----......|..........|----......|..........|----......|..........|----......|    .     -     .    |..........|----......|......B...|----......|..........|----......|..........|----......|..........|...||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
	 db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||------|----..... |..........|----......|..........|----......|.....B....|----......|..........|----......|.         -     .    |..........|----......|......B...|----......|..........|----......|..........|----......|..........|...||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||------|----..... |..........|----......|..........|----......|..........|----......|..........|----......|.   .     -   .      |..........|----......|......B...|----......|..........|----......|..........|----......|..........|...||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
	 db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "        |----..... |..........|----......|..........|----......|....B.....|----......|..........|----......|    .     -      .   |..........|----......|......B...|----......|..........|----......|..........|----......|..........|     ",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||------|----..... |..........|----......|..........|----......|..........|----......|..........|----......|      .   -     .    |..........|----......|......B...|----......|..........|----......|..........|----......|..........|...||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||......            __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||------|----..... |..........|----......|..........|----......|..........|----......|..........|----......|..   .    -     .    |..........|----......|......B...|----......|..........|----......|..........|----......|..........|...||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||......|__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
     db "||                                                                                                                                                                                                                                      ||",0
	 db "||                  __________            __________            __________            __________            __________            __________            __________            __________            __________            __________....||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|                     |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||------|----..... |..........|----......|       .  |----......|.         |----......|.         |----......|.    .    -        . |     .    |----  .   |.     B   |----......|..........|----......|..........|----......|..........|...||",0
	 db "||      |      ----|          |      ----|          |      ----|          |      ----|          |      ----|          -          |          |      ----|          |      ----|          |      ----|          |      ----|          |   ||",0
	 db "||.     |__________|          |__________|          |__________|          |__________|          |__________|          -__________|          |__________|          |__________|          |__________|          |__________|          |...||",0
	 db "||                                                                                                                                                                                                                                      ||",0	 
	 db "||.   .                     .                .                .                     .                                .                                                                                                                  ||",0
	 db "||                                                                                                                                                                                                                                      ||",0	 
	 db "|| .                                  .                                     .                                                   .                           .                                                   .                       ||",0
	 db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0	 
	 db "||--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------||",0
	 db "                                                                                                                                                                                                                                          ",0
	 db "                                                                                                                                                                                                                                          ",0
	 db "                                                                                                                                                                                                                                          ",0


display db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0	
     db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|...............................                  ..........                  ...........                  .........                       ...........                ..........  .......................................................|",0
	 db "|..............................   .............   ........  ................  ........   .........................   ........    ........   ........  ...............  ........                     .....................................|",0
	 db "|..............................  ...............  ........  ................  ........  ..........................  ..........  ..........  ........  ...............  ........    ..............    ....................................|",0
	 db "|..............................  ...............  ........  ................  ........  ..........................  ..........  ..........  ........  ...............  ........   ................   ....................................|",0
	 db "|..............................  ...............  ........  ................  ........  ..........................  ..........  ..........  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  ...............  ........  ................  ........  ..........................  ..........  ..........  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................   .............   ........  ................  ........  ..........................  ..........  ..........  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................                   ........                    ........  ..........................  ..........  ..........  ........                   ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ........  ..........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ........  ..........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ........  ..........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ........  ..........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ........  ..........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ........  ..........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  .........  .........................  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|..............................  .........................  ................  ..........                  ........  ......................  ........  ...............  ........  ..................  ....................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0

menu db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0	
     db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                           1) START GAME                           .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                           2) INSTRUCTIONS                         .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                           3) SCORES                               .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                           4) EXIT GAME                            .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0

	 
gameoverScreen db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0	
     db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                            GAME OVER :(                           .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0


	 
endScreen db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0	
     db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                            GAME END	                           .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0

	 
InstructionsScreen db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0;167 37    45
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0	
     db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                Use A,W,S,D to move the pacman                     .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                  Don't collide with ghosts                        .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                  Press P to pause the game                        .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................             Earn coins('B') to increase the score                 .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|..............................................................................                                                                   .......................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "|........................................................................................................................................................................................................................................|",0
	 db "------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",0

blank db "||                                                                                                                                                                                                                                      ||",0	 


	nametitle BYTE "NAME",0
    scoretitle BYTE "SCORE:   ",0
    leveltitle BYTE "LEVEL: ",0

    buffer BYTE 5000 DUP(?)
    filename BYTE "output.txt", 0
    fileHandle HANDLE ?
    stringLength dw ?
    bytesWritten DWORD ?
    bytesRead db 0
    str1 BYTE "Cannot create file ", 0
    str2 BYTE "Bytes written to file [output.txt]:", 0
    str3 BYTE "Enter up to 500 characters and press [Enter]: ", 0


strScore BYTE "Your score is: ",0
score word 0

level db 1

lives db 3
strLives BYTE "Lives: ",0


xPos BYTE 118
yPos BYTE 46

x dd 235
y dd 53

xGhostPos BYTE 2
yGhostPos BYTE 2

xGhostPos2 BYTE 150
yGhostPos2 BYTE 2

xGhostPos3 BYTE 150 
yGhostPos3 BYTE 15

xCoinPos BYTE ?
yCoinPos BYTE ?

inputChar BYTE ?

pacman BYTE ?
character dd ?

username BYTE "Enter your name: ",0
user BYTE 10 dup(?)

ghostDelay dd 0
ghostDelay2 dd 0
ghostDelay3 dd 0
ghostlevel dd 6

endgame db 0

tele1x db 1 ;left wall
tele1y db 23

tele2x db 232 ; right wall
tele2y db 23

pause_sc db 0

deathsound BYTE "pacman_death.wav", 0
dotsound BYTE "pac_cherry.wav", 0


.code
main PROC

	; draw ground at (0,29):
	;Screen 1 Name Display
	;call ReadFileContents

	call Screen1
	menuagain:
	call MENUSCREEN
	cmp al,'1'
	je cont
	cmp al,'4'
	je exitgame
	cmp al,'2'
	jne next
	call instructions
	jmp menuagain
	next:
	cmp al,'3'
	jne cont
	call ReadFileContents
	jmp menuagain
	cont:
	
	call LEVEL3
	mov al,endgame
	cmp al,1
	je gameOver

	mov al,level
	cmp al,2
	je LEVEL2

	mov al,endgame
	cmp al,1
	je gameOver

	mov al,level
	cmp al,3
	je LEVEL3

	mov al,endgame
	cmp al,1
	je gameOver


	exitgame:
	exit
main ENDP

LEVEL1 PROC
		pusha
		
		gameLoop:
		mov al,pause_sc
		cmp al,0
		jne set_pause
		je cont
		set_pause:
		inc pause_sc
		CALL PAUSESCREEN
		cmp al,'p'
		jne gameLoop
		dec pause_sc
		cont:
	    mov al,lives
		cmp al,0
		je exitGame
		inc ghostDelay
		mov esi,OFFSET maze
		call level1Maze
		
		call DrawPlayer
		call UpdateGhost
		call CollisionGhost
		call DrawGhost
		call UserNameDisplay

		call DrawLevels
		
		mov eax,white (black * 16)
		call SetTextColor

		
		call DrawScore
		call DrawLives
		
		
		mov esi,offset maze
		; get user key input:
		call Delay
		call ReadKey
		jz gotogameloop
		mov inputChar,al

		; exit game if user types 'x':
		cmp inputChar,"p"
		je set_pause
		cmp inputChar,"x"
		je exitGame

		cmp inputChar,"w"
		je moveUp

		cmp inputChar,"s"
		je moveDown

		cmp inputChar,"a"
		je moveLeft

		cmp inputChar,"d"
		je moveRight

		moveUp:
		
			call UpdatePlayer
			dec yPos
			mov esi,offset maze
			call CollisionDetection
			cmp al,' '
			je up
			inc yPos
			up:
			call DrawPlayer
			mov eax,70

		jmp gameLoop

		moveDown:
		
		
		call UpdatePlayer
		inc yPos
		mov esi,offset maze
		call CollisionDetection
		cmp al,' '
		je down
		dec yPos
		down:
		call DrawPlayer
		jmp gameLoop

		moveLeft:
		call UpdatePlayer
		dec xPos
		mov esi,offset maze
		call CollisionDetection
		cmp al,' '
		je left
		inc xPos
		left:
		call DrawPlayer
		jmp gameLoop

		moveRight:
		call UpdatePlayer
		inc xPos
		mov esi,offset maze
		call CollisionDetection
		cmp al,' '
		je right
		dec xPos
		right:
		call DrawPlayer
		jmp gameLoop


		gotogameloop:
		call Dots
		cmp al,"."
		je levelupgrade
	
	jmp gameLoop

	exitGame:
	mov endgame,1
	popa
	ret
	levelupgrade:
		inc level
	popa
	RET
LEVEL1 ENDP

LEVEL2 PROC
pusha
		mov eax,ghostlevel
		mov eax,5
		mov ghostlevel,eax
		gameLoop:
		mov al,pause_sc
		cmp al,0
		jne set_pause
		je cont
		set_pause:
		inc pause_sc
		CALL PAUSESCREEN
		cmp al,'p'
		jne gameLoop
		dec pause_sc
		cont:
	    mov al,lives
		cmp al,0
		je exitGame
		inc ghostDelay
		mov esi,OFFSET maze2
		call level1Maze
		
		call DrawPlayer
		
		
		call UpdateGhost
		call CollisionGhost
		call DrawGhost

		call DrawLevels
		
		mov eax,white (black * 16)
		call SetTextColor

		call UserNameDisplay
		call DrawScore
		call DrawLives
		
		
		mov esi,offset maze2
		; get user key input:
		call Delay
		;call ReadChar
		call ReadKey
		jz gotogameloop
		mov inputChar,al

		; exit game if user types 'x':
		cmp inputChar,"p"
		je set_pause
		cmp inputChar,"x"
		je exitGame

		cmp inputChar,"w"
		je moveUp

		cmp inputChar,"s"
		je moveDown

		cmp inputChar,"a"
		je moveLeft

		cmp inputChar,"d"
		je moveRight

		moveUp:
		
			call UpdatePlayer
			dec yPos
			mov esi,offset maze2
			call CollisionDetection
			cmp al,' '
			je up
			inc yPos
			up:
			call DrawPlayer
			mov eax,70

		jmp gameLoop

		moveDown:
		
		
		call UpdatePlayer
		inc yPos
		mov esi,offset maze2
		call CollisionDetection
		cmp al,' '
		je down
		dec yPos
		down:
		call DrawPlayer
		jmp gameLoop

		moveLeft:
		call UpdatePlayer
		dec xPos
		mov esi,offset maze2
		call CollisionDetection
		cmp al,' '
		je left
		inc xPos
		left:
		call DrawPlayer
		jmp gameLoop

		moveRight:
		call UpdatePlayer
		inc xPos
		mov esi,offset maze2
		call CollisionDetection
		cmp al,' '
		je right
		dec xPos
		right:
		call DrawPlayer
		jmp gameLoop


		gotogameloop:
		call Dots
		cmp al,"."
		je levelupgrade
	
	jmp gameLoop

	exitGame:
	mov endgame,1
	popa
	ret
	levelupgrade:
		inc level
	popa
	RET
LEVEL2 ENDP

LEVEL3 PROC
pusha
		
		gameLoop:
		mov al,pause_sc
		cmp al,0
		jne set_pause
		je cont
		set_pause:
		inc pause_sc
		CALL PAUSESCREEN
		cmp al,'p'
		jne gameLoop
		dec pause_sc
		cont:
	    mov al,lives
		cmp al,0
		je exitGame
		call teleportation 
		inc ghostDelay
		inc ghostDelay2
		inc ghostDelay3
		mov esi,OFFSET maze3
		call level1Maze
		
		call DrawPlayer
		
		
		call UpdateGhost
	    call CollisionGhost
		call DrawGhost

		call UpdateGhost2
	    call CollisionGhost2
		call DrawGhost2
		
		
		call UpdateGhost3
	    call CollisionGhost3
		call DrawGhost3

		call UserNameDisplay
		call DrawLevels
		
		mov eax,white (black * 16)
		call SetTextColor

		
		call DrawScore
		call DrawLives
		
		
		mov esi,offset maze3
		; get user key input:
		call Delay
		;call ReadChar
		call ReadKey
		jz gotogameloop
		mov inputChar,al

		; exit game if user types 'x':
		cmp inputChar,"p"
		je set_pause
		cmp inputChar,"x"
		je exitGame

		cmp inputChar,"w"
		je moveUp

		cmp inputChar,"s"
		je moveDown

		cmp inputChar,"a"
		je moveLeft

		cmp inputChar,"d"
		je moveRight

		moveUp:
		
			call UpdatePlayer
			dec yPos
			mov esi,offset maze3
			call CollisionDetection
			cmp al,' '
			je up
			inc yPos
			up:
			call DrawPlayer
			mov eax,70

		jmp gameLoop

		moveDown:
		
		
		call UpdatePlayer
		inc yPos
		mov esi,offset maze3
		call CollisionDetection
		cmp al,' '
		je down
		dec yPos
		down:
		call DrawPlayer
		jmp gameLoop

		moveLeft:
		call UpdatePlayer
		dec xPos
		mov esi,offset maze3
		call CollisionDetection
		cmp al,' '
		je left
		inc xPos
		left:
		call DrawPlayer
		jmp gameLoop

		moveRight:
		call UpdatePlayer
		inc xPos
		mov esi,offset maze3
		call CollisionDetection
		cmp al,' '
		je right
		dec xPos
		right:
		call DrawPlayer
		jmp gameLoop


		gotogameloop:
		call Dots
		cmp al,"."
		je levelupgrade
	
	jmp gameLoop

	exitGame:
	mov endgame,1
	popa
	ret
	levelupgrade:
		call end_Screen
	popa
	RET
LEVEL3 ENDP

CollisionDetection PROC
	;Handling collision 
		mov ecx,0
		mov cl,yPos
		
		collision_y: ; y coord
		add esi,x
		loop collision_y
		mov cl,xPos
		collision_x: ; x coord
		inc esi
		loop collision_x
		mov al,[esi]
		cmp al,'-'
		je no_movement
		cmp al,'|'
		je no_movement
		cmp al,'_'
		je no_movement
		jmp move
		move:
		cmp al,'.'
		jne no_dot
		INVOKE PlaySound, OFFSET dotsound, NULL,0
		inc score
		mov eax,' '
		mov [esi],eax
		jmp no_bonus
		no_dot:
		cmp al,'B'
		jne no_bonus
		inc score
		inc score
		inc score
		inc score
		inc score
		mov eax,' '
		mov [esi],eax
		no_bonus:
		mov al,' '		

		no_movement:
		ret
CollisionDetection ENDP

CollisionGhost PROC
	
			;check Ghost Delay
		mov eax,ghostDelay
		cmp eax,5
		jne end_ftn
		mov eax,0
		mov ghostDelay,0
		;follow the player
		mov al,yGhostPos
		cmp al,yPos
		jl mov_x
		je equal
		dec yGhostPos
		jmp end_ftn
		mov_x:
		inc yGhostPos
		jmp end_ftn

		check_y:
		mov al,xGhostPos
		cmp al,xPos
		jl mov_y
		dec xGhostPos
		jmp end_ftn
		mov_y:
		inc xGhostPos
		jmp end_ftn
		
		equal:
		mov al,xGhostPos
		cmp al,xPos
		jne check_y
		call UpdatePlayer
		INVOKE PlaySound, OFFSET deathsound, NULL,0
		mov xPos,2
		mov yPos,45
		mov al,lives
		;cmp al,1
		;je endgame
		dec lives
		jmp end_ftn
		;endgame:
		;call gameOver
		end_ftn:

		ret

CollisionGhost ENDP

CollisionGhost2 PROC
	
		
		;check Ghost Delay
		mov eax,ghostDelay2
		cmp eax,2
		jne end_ftn
		mov eax,0
		mov ghostDelay2,0
		;follow the player
		mov al,xGhostPos2
		cmp al,xPos
		jl mov_x
		je equal
		dec xGhostPos2
		jmp end_ftn
		mov_x:
		inc xGhostPos2
		jmp end_ftn

		check_y:
		mov al,yGhostPos2
		cmp al,yPos
		jl mov_y
		dec yGhostPos2
		jmp end_ftn
		mov_y:
		inc yGhostPos2
		jmp end_ftn
		
		equal:
		mov al,yGhostPos2
		cmp al,yPos
		jne check_y
		call UpdatePlayer
		INVOKE PlaySound, OFFSET deathsound, NULL,0
		mov xPos,2
		mov yPos,45
		mov al,lives
		;cmp al,1
		;je endgame
		dec lives
		jmp end_ftn
		;endgame:
		;call gameOver
		end_ftn:

		ret

CollisionGhost2 ENDP

CollisionGhost3 PROC
	
		
		;check Ghost Delay
		mov eax,ghostDelay3
		cmp eax,5
		jne end_ftn
		mov eax,0
		mov ghostDelay3,0
		;follow the player
		mov al,yGhostPos3
		cmp al,yPos
		jl mov_x
		je equal
		dec yGhostPos3
		jmp end_ftn
		mov_x:
		inc yGhostPos3
		jmp end_ftn

		check_y:
		mov al,xGhostPos3
		cmp al,xPos
		jl mov_y
		dec xGhostPos3
		jmp end_ftn
		mov_y:
		inc xGhostPos3
		jmp end_ftn
		
		equal:
		mov al,xGhostPos3
		cmp al,xPos
		jne check_y
		call UpdatePlayer
		INVOKE PlaySound, OFFSET deathsound, NULL,0
		mov xPos,2
		mov yPos,45
		mov al,lives
		;cmp al,1
		;je endgame
		dec lives
		jmp end_ftn
		;endgame:
		;call gameOver
		end_ftn:

		ret

CollisionGhost3 ENDP

DrawPlayer PROC
	; draw player at (xPos,yPos):
	mov eax, red + (cyan * 16)
    call SetTextColor
	mov dl,xPos
	mov dh,yPos
	call Gotoxy
	mov al,"<"
	call WriteChar
	ret
DrawPlayer ENDP

UpdatePlayer PROC
	
	mov dl,xPos
	mov dh,yPos
	

	mov eax, black + (Cyan * 16)
    call SetTextColor
	call Gotoxy
	mov al," "
	call WriteChar

	ret
UpdatePlayer ENDP

DrawGhost PROC
	mov eax,red + (red * 16)
	call SetTextColor
	mov dl,xGhostPos
	mov dh,yGhostPos
	call Gotoxy
	mov al," "
	call WriteChar
	ret
DrawGhost ENDP

UpdateGhost PROC
	
	mov dl,xGhostPos
	mov dh,yGhostPos
	

	mov eax, cyan + (Cyan * 16)
    call SetTextColor
	call Gotoxy
	mov al," "
	call WriteChar

	ret
UpdateGhost ENDP

DrawGhost2 PROC
	mov eax,black + (black * 16)
	call SetTextColor
	mov dl,xGhostPos2
	mov dh,yGhostPos2
	call Gotoxy
	mov al," "
	call WriteChar
	ret
DrawGhost2 ENDP

UpdateGhost2 PROC
	
	mov dl,xGhostPos2
	mov dh,yGhostPos2
	

	mov eax, cyan + (Cyan * 16)
    call SetTextColor
	call Gotoxy
	mov al," "
	call WriteChar

	ret
UpdateGhost2 ENDP

DrawGhost3 PROC
	mov eax,blue + (blue * 16)
	call SetTextColor
	mov dl,xGhostPos3
	mov dh,yGhostPos3
	call Gotoxy
	mov al," "
	call WriteChar
	ret
DrawGhost3 ENDP

UpdateGhost3 PROC
	
	mov dl,xGhostPos3
	mov dh,yGhostPos3
	

	mov eax, cyan + (Cyan * 16)
    call SetTextColor
	call Gotoxy
	mov al," "
	call WriteChar

	ret
UpdateGhost3 ENDP

DrawScore PROC
	pusha
	mov eax,black + (cyan * 16)
	call SetTextColor
	mov dl,0
	mov dh,51
	call Gotoxy
	mov edx,OFFSET strScore
	call WriteString
	mov ax,score
	call Writedec

	popa
	ret
DrawScore ENDP
	

DrawLives PROC
	pusha
	mov eax,black + (cyan * 16)
	call SetTextColor
	mov dl,220
	mov dh,51
	call Gotoxy
	mov edx,OFFSET strLives
	call WriteString
	mov al,lives
	call Writedec
	popa
	ret
DrawLives ENDP

DrawLevels PROC
	pusha
	mov eax,black + (cyan * 16)
	call SetTextColor
	mov dl,150
	mov dh,51
	call Gotoxy
	mov edx,OFFSET leveltitle
	call WriteString
	mov al,level
	call Writedec
	popa
	ret
DrawLevels ENDP

UserNameDisplay PROC
	pusha
	mov eax,black + (cyan * 16)
	call SetTextColor
		mov dh,51
		mov dl,100
		call Gotoxy
		mov edx, OFFSET user
		call WriteString
		popa
		ret
UserNameDisplay ENDP

teleportation proc
	mov al,xPos
	mov ah,yPos
	cmp al,tele1x
	jne second
	cmp ah,tele1y
	jne second
	mov al,tele2x
	dec al
	mov ah,tele2y
	mov xPos,al
	mov yPos,ah
	jmp endftn

	second:
	cmp al,tele2x
	jne endftn
	cmp ah,tele2y
	jne endftn
	mov al,tele1x
	inc al
	mov ah,tele1y
	mov xPos,al
	mov yPos,ah
	

	endftn:
	ret
teleportation endp

Screen1 PROC
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		mov edx,OFFSET Display
		mov esi,edx
		mov ecx,y
		s1a:
		mov character,ecx
		mov ecx,x
		s1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		
		mov ah," "
		mov al,[esi]
		cmp ah,al
		jne write
		mov eax, black + (black * 16)
		call SetTextColor
		write:
		mov eax,0
		mov eax,[esi]
		call WriteChar
		mov eax, black + (Cyan * 16)
		call SetTextColor
		inc bl
		inc esi
		loop s1
		mov ecx,character
		inc bh
		mov bl,0
		loop s1a

		mov edx,offset username
		call WriteString
		mov edx,offset user
		mov ecx,sizeof user
		call ReadString
		
		ret
Screen1 ENDP
PAUSESCREEN PROC
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		mov edx,OFFSET menu
		mov esi,edx
		mov ecx,y
		s1a:
		mov character,ecx
		mov ecx,x
		s1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		
		mov ah,"."
		mov al,[esi]
		cmp ah,al
		je write
		mov eax, white + (lightBlue * 16)
		call SetTextColor
		write:
		mov eax,0
		mov eax,[esi]
		call WriteChar
		mov eax, black + (Cyan * 16)
		call SetTextColor
		inc bl
		inc esi
		loop s1
		mov ecx,character
		inc bh
		mov bl,0
		loop s1a
		again:
		mov esi,offset pacman
		call ReadChar
		cmp al,'p'
		jne again
		ret
PAUSESCREEN ENDP
MENUSCREEN PROC
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		mov edx,OFFSET menu
		mov esi,edx
		mov ecx,y
		s1a:
		mov character,ecx
		mov ecx,x
		s1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		
		mov ah,"."
		mov al,[esi]
		cmp ah,al
		je write
		mov eax, white + (lightBlue * 16)
		call SetTextColor
		write:
		mov eax,0
		mov eax,[esi]
		call WriteChar
		mov eax, black + (Cyan * 16)
		call SetTextColor
		inc bl
		inc esi
		loop s1
		mov ecx,character
		inc bh
		mov bl,0
		loop s1a
		again:
		mov esi,offset pacman
		call ReadChar
		
		ret
MENUSCREEN ENDP

Instructions PROC
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		mov edx,OFFSET instructionsscreen
		mov esi,edx
		mov ecx,y
		s1a:
		mov character,ecx
		mov ecx,x
		s1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		
		mov ah,"."
		mov al,[esi]
		cmp ah,al
		je write
		mov eax, white + (lightBlue * 16)
		call SetTextColor
		write:
		mov eax,0
		mov eax,[esi]
		call WriteChar
		mov eax, black + (Cyan * 16)
		call SetTextColor
		inc bl
		inc esi
		loop s1
		mov ecx,character
		inc bh
		mov bl,0
		loop s1a

		mov esi,offset pacman
		call ReadChar
		
		ret
Instructions ENDP

level1Maze PROC
		push esi
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (yellow * 16)
		call SetTextColor
		
		mov ecx,y
		maze1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		mov edx,esi
		call WriteString
		inc bh
		add esi,x
		loop maze1
		pop esi
		ret
level1Maze ENDP

level2Maze PROC
		push esi
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		
		mov ecx,y
		maze1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		mov edx,esi
		call WriteString
		inc bh
		add esi,x
		loop maze1
		pop esi
		ret
level2Maze ENDP

Dots PROC
		pusha
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
	
		mov edx,OFFSET Display
		mov esi,edx
		mov ecx,y
		s1a:
		mov character,ecx
		mov ecx,x
		s1:
		mov ah,"."
		mov al,[esi]
		cmp ah,al
		jne no_dot
		mov character,'.'
		popa
		ret
		no_dot:
		inc bl
		inc esi
		loop s1
		mov ecx,character
		inc bh
		mov bl,0
		loop s1a
		popa
		ret
Dots ENDP
GameOver PROC
		pusha

		mov esi,offset gameoverScreen
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		
		mov ecx,y
		maze1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		mov edx,esi
		call WriteString
		inc bh
		add esi,x
		loop maze1
		call fileinput
		popa
		ret
GameOver ENDP

end_Screen PROC
		pusha

		mov esi,offset endScreen
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		
		mov ecx,y
		maze1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		mov edx,esi
		call WriteString
		inc bh
		add esi,x
		loop maze1
		call fileinput
		popa
		ret
end_screen ENDP


fileinput PROC USES edx eax ebx ecx
    mov ax, 0
    mov al, lengthof user
    mov stringLength, ax  ;store the size of string

    ; Try to open the file for appending or create a new file if it doesn't exist
    invoke CreateFile, ADDR filename, FILE_APPEND_DATA, FILE_SHARE_READ, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL
    mov fileHandle, eax

    cmp eax, INVALID_HANDLE_VALUE   ; Check for errors.
    je  quit ; If error found, jump to quit

    ; The file is opened successfully, proceed to writing

    ; the following code segment stores the name string into the buffer
    mov esi, offset user
    mov edi, offset buffer
	mov ecx,0
    mov cx, stringLength
    rep movsb ; Copy the name string to the buffer

	
    ; Remove the newline character at the end of the buffer
	mov esi,edi
	mov ecx,10
	mov eax,0ah
	newline:
	cmp eax,[esi]
	jne cont
	mov eax,20h
	mov [esi],eax
	cont:
    dec esi
	loop newline
 
    mov al, 32
    mov [edi], al
    inc edi

;///////////////////////////////////////////////////////// SCORES /////////////////////////////////////////////////
     ; the following code segment stores the score into the buffer
    movzx eax, score
    mov ebx, 10

    add edi,4
    ; Handle the thousands digit
    mov edx,0
    div ebx
    mov score,ax
    add dl, '0'  ; Convert the thousands digit to ASCII
    mov [edi], dl ; Store the thousands digit
    dec edi

    ; Move to the next character in the buffer
    movzx eax, score ; Retrieve the hundreds digit
    mov edx,0
    div ebx
    mov score,ax
    add dl, '0'      ; Convert the hundreds digit to ASCII
    mov [edi], dl    ; Store the hundreds digit
    dec edi

     ; Move to the next character in the buffer
    movzx eax, score ; Retrieve the tens digit
    mov edx,0
    div ebx
    mov score,ax
    add dl, '0'      ; Convert the tens digit to ASCII
    mov [edi], dl    ; Store the tens digit
    dec edi

     ; Move to the next character in the buffer
    movzx eax, score ; Retrieve the ones digit
    mov edx,0
    div ebx
    mov score,ax
    add dl, '0'      ; Convert the ones digit to ASCII
    mov [edi], dl    ; Store the ones digit
    add edi,4

    mov ax, 32
    mov [edi], ax
    inc edi

;///////////////////////////////////////////////////////// LEVEL /////////////////////////////////////////////////

        ; the following code segment stores the score into the buffer
    movzx eax, level
   
    add al, '0'  
    mov [edi], al 

    ; Move to the next line
    inc edi
    mov al, 0ah
    mov [edi], al     

    mov bx,stringLength
    add bx, 8
    mov stringLength,bx
    inc stringLength ;new line
    ; Write the buffer to the output file.
    mov eax, fileHandle
    mov edx, OFFSET buffer
    mov cx, stringLength 
    call WriteToFile       ; Save return value

    ; Close the file handle
    invoke CloseHandle, fileHandle

quit:
    ret

fileinput ENDP

ReadFileContents PROC
		mov esi,offset blank
		mov dl,0
		mov dh,0
		mov bl,dl
		mov bh,dh
		call Gotoxy
		mov eax, black + (Cyan * 16)
		call SetTextColor
		
		mov ecx,y
		maze1:
		mov dl,bl
		mov dh,bh
		call Gotoxy
		mov edx,esi
		call WriteString
		inc bh
		loop maze1
    ; Open the file for reading
    invoke CreateFile, ADDR filename, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL
    mov fileHandle, eax

    cmp eax, INVALID_HANDLE_VALUE   ; Check for errors.
    je  quit ; If error found, jump to quit

    ; Read the file into the buffer
    mov edx, OFFSET buffer
    mov ecx, 5000
    call ReadFromFile
    
    ; Write the buffer to the console character by character
	
	mov dl,80
	mov dh,10
call Gotoxy
	mov bl,dl
	mov bh,dh
    ; Display the contents of the file
	mov eax, blue + (red * 16)
    mWrite <"UserName Score Level:", 0dh, 0ah>
    mov esi, OFFSET buffer
    mov ecx, 5000
	inc bh
	mov dl,bl
	mov dh,bh
	call Gotoxy
	
    print_loop:
    mov al, [esi]          ; Load the next character from the buffer
    
	movzx eax, al          ; Zero-extend the character to 32 bits
    call WriteChar         ; Print the character
    inc esi                ; Move to the next character in the buffer
    ;inc bh
	mov eax,0
	mov al,[esi]
	cmp al,0ah
	jne incbh
	inc bh
	mov dl,bl
	mov dh,bh
	inc esi
	call Gotoxy
	incbh:
	loop print_loop        ; Repeat for the entire buffer

    done_printing:

    ; Close the file handle
    invoke CloseHandle, fileHandle

quit:
	mov esi,offset pacman
		call ReadChar
    ret
ReadFileContents ENDP

END main